<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>EdgeFrame sorted_k &mdash; Trusted Analytics Platform 0.4.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../../f_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../f_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../../f_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../../../f_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../f_static/jquery.js"></script>
    <script type="text/javascript" src="../../../f_static/underscore.js"></script>
    <script type="text/javascript" src="../../../f_static/doctools.js"></script>
    <script type="text/javascript" src="../../../f_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" >
    <link rel="top" title="Trusted Analytics Platform 0.4.0 documentation" href="../../../index.html" >
    <link rel="up" title="Frames EdgeFrame" href="index.html" >
    <link rel="next" title="EdgeFrame status" href="status.html" >
    <link rel="prev" title="EdgeFrame sort" href="sort.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../../../index.html">Trusted Analytics</a></li>
	
          <li class="active"><a href="../../index.html" >Python API</a></li>
          <li class="active"><a href="../index.html" >Frames</a></li>
          <li class="active"><a href="index.html" accesskey="U"><code class="docutils literal"><span class="pre">Frames</span></code> EdgeFrame</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="sort.html" title="EdgeFrame sort"
           accesskey="P">previous</a>
      </li>
      <li class="active">
        <a href="status.html" title="EdgeFrame status"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="../../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Technical Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ds_over.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_over.html">Extending Trusted Analytics Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ad_over.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest_api/v1/index.html">REST API</a></li>
</ul>
<ul class="simple">
</ul>

        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="edgeframe-sorted-k">
<span id="python-api-frames-frame-edge-sorted-k"></span><h1><a class="reference internal" href="index.html"><em>EdgeFrame</em></a>  sorted_k<a class="headerlink" href="#edgeframe-sorted-k" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<dl class="function">
<dt id="sorted_k">
<code class="descname">sorted_k</code><span class="sig-paren">(</span><em>self</em>, <em>k</em>, <em>column_names_and_ascending</em>, <em>reduce_tree_depth=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sorted_k" title="Permalink to this definition">¶</a></dt>
<dd><p><abbr title="This is a function or feature which has been developed, but has not been completely tested.  Use this function with caution.  This function may be changed or eliminated in future releases.">[ALPHA]</abbr>
Get a sorted subset of the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>k</strong> : int32</p>
<blockquote>
<div><p>Number of sorted records to return.</p>
</div></blockquote>
<p><strong>column_names_and_ascending</strong> : list</p>
<blockquote>
<div><p>Column names to sort by, and true to sort column by ascending order,
or false for descending order.</p>
</div></blockquote>
<p><strong>reduce_tree_depth</strong> : int32 (default=None)</p>
<blockquote>
<div><p>Advanced tuning parameter which determines the depth of the
reduce-tree (uses Spark&#8217;s treeReduce() for scalability.)
Default is 2.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">: Frame</p>
<blockquote class="last">
<div><p>A new frame with a subset of sorted rows from the original frame.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p>Take a number of rows and return them
sorted in either ascending or descending order.</p>
<p>Sorting a subset of rows is more efficient than sorting the entire frame when
the number of sorted rows is much less than the total number of rows in the frame.</p>
<p class="rubric">Notes</p>
<p>The number of sorted rows should be much smaller than the number of rows
in the original frame.</p>
<p>In particular:</p>
<ol class="arabic simple">
<li>The number of sorted rows returned should fit in Spark driver memory.
The maximum size of serialized results that can fit in the Spark driver is
set by the Spark configuration parameter <em>spark.driver.maxResultSize</em>.</li>
<li>If you encounter a Kryo buffer overflow exception, increase the Spark
configuration parameter <em>spark.kryoserializer.buffer.max.mb</em>.</li>
<li>Use Frame.sort() instead if the number of sorted rows is very large (in
other words, it cannot fit in Spark driver memory).</li>
</ol>
<p class="rubric">Examples</p>
<p>These examples deal with the most recently-released movies in a private collection.
Consider the movie collection already stored in the frame below:</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">big_frame</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="go">  genre:str  year:int32   title:str</span>
<span class="go">/-----------------------------------/</span>
<span class="go">  Drama        1957       12 Angry Men</span>
<span class="go">  Crime        1946       The Big Sleep</span>
<span class="go">  Western      1969       Butch Cassidy and the Sundance Kid</span>
<span class="go">  Drama        1971       A Clockwork Orange</span>
<span class="go">  Drama        2008       The Dark Knight</span>
<span class="go">  Animation    2013       Frozen</span>
<span class="go">  Drama        1972       The Godfather</span>
<span class="go">  Animation    1994       The Lion King</span>
<span class="go">  Animation    2010       Tangled</span>
<span class="go">  Fantasy      1939       The Wonderful Wizard of Oz</span>
</pre></div>
</div>
<p>This example returns the top 3 rows sorted by a single column: &#8216;year&#8217; descending:</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span> <span class="o">=</span> <span class="n">big_frame</span><span class="o">.</span><span class="n">sorted_k</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;year&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span><span class="o">.</span><span class="n">inspect</span><span class="p">()</span>

<span class="go">  genre:str  year:int32   title:str</span>
<span class="go">/-----------------------------------/</span>
<span class="go">  Animation    2013       Frozen</span>
<span class="go">  Animation    2010       Tangled</span>
<span class="go">  Drama        2008       The Dark Knight</span>
</pre></div>
</div>
<p>This example returns the top 5 rows sorted by multiple columns: &#8216;genre&#8217; ascending, then &#8216;year&#8217; descending:</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span> <span class="o">=</span> <span class="n">big_frame</span><span class="o">.</span><span class="n">sorted_k</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;genre&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;year&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span><span class="o">.</span><span class="n">inspect</span><span class="p">()</span>

<span class="go">  genre:str  year:int32   title:str</span>
<span class="go">/-----------------------------------/</span>
<span class="go">  Animation    2013       Frozen</span>
<span class="go">  Animation    2010       Tangled</span>
<span class="go">  Animation    1994       The Lion King</span>
<span class="go">  Crime        1946       The Big Sleep</span>
<span class="go">  Drama        2008       The Dark Knight</span>
</pre></div>
</div>
<p>This example returns the top 5 rows sorted by multiple columns: &#8216;genre&#8217;
ascending, then &#8216;year&#8217; ascending.
It also illustrates the optional tuning parameter for reduce-tree depth
(which does not affect the final result).</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span> <span class="o">=</span> <span class="n">big_frame</span><span class="o">.</span><span class="n">sorted_k</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;genre&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;year&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="p">],</span> <span class="n">reduce_tree_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topk_frame</span><span class="o">.</span><span class="n">inspect</span><span class="p">()</span>

<span class="go">  genre:str  year:int32   title:str</span>
<span class="go">/-----------------------------------/</span>
<span class="go">  Animation    1994       The Lion King</span>
<span class="go">  Animation    2010       Tangled</span>
<span class="go">  Animation    2013       Frozen</span>
<span class="go">  Crime        1946       The Big Sleep</span>
<span class="go">  Drama        1972       The Godfather</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2015, Intel.
      </li>
      <li>
      Last updated on Oct 21, 2015.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>