<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Plugin Authoring Guide &mdash; Trusted Analytics Platform 0.6.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="R_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="R_static/css/spc-extend.css">
    <link rel="stylesheet" href="R_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="R_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="R_static/jquery.js"></script>
    <script type="text/javascript" src="R_static/underscore.js"></script>
    <script type="text/javascript" src="R_static/doctools.js"></script>
    <script type="text/javascript" src="R_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="top" title="Trusted Analytics Platform 0.6.0 documentation" href="index.html" >
    <link rel="up" title="Extending Trusted Analytics Platform" href="dev_over.html" >
    <link rel="next" title="Administration" href="ad_over.html" >
    <link rel="prev" title="Extending Trusted Analytics Platform" href="dev_over.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="index.html">Trusted Analytics</a></li>
	
          <li class="active"><a href="dev_over.html" accesskey="U">Extending Trusted Analytics Platform</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="dev_over.html" title="Extending Trusted Analytics Platform"
           accesskey="P">previous</a>
      </li>
      <li class="active">
        <a href="ad_over.html" title="Administration"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Technical Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="ds_over.html">User Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dev_over.html">Extending Trusted Analytics Platform</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Plugin Authoring Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ad_over.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest_api/v1/index.html">REST API</a></li>
</ul>
<ul class="simple">
</ul>

        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <span class="target" id="dev-plug"></span><div class="section" id="plugin-authoring-guide">
<span id="index-0"></span><h1>Plugin Authoring Guide<a class="headerlink" href="#plugin-authoring-guide" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a></li>
<li><a class="reference internal" href="#when-to-write-a-plugin" id="id2">When to Write a Plugin</a></li>
<li><a class="reference internal" href="#plugin-support-services" id="id3">Plugin Support Services</a><ul>
<li><a class="reference internal" href="#plugin-life-cycle" id="id4">Plugin Life Cycle</a></li>
<li><a class="reference internal" href="#logging-and-error-handling" id="id5">Logging and Error Handling</a></li>
<li><a class="reference internal" href="#defaulting-arguments" id="id6">Defaulting Arguments</a></li>
<li><a class="reference internal" href="#execution-flow" id="id7">Execution Flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-commandplugin" id="id8">Creating a CommandPlugin</a><ul>
<li><a class="reference internal" href="#naming" id="id9">Naming</a></li>
<li><a class="reference internal" href="#rest-input-and-output" id="id10">REST Input and Output</a></li>
<li><a class="reference internal" href="#frame-and-graph-references" id="id11">Frame and Graph References</a></li>
<li><a class="reference internal" href="#single-value-results" id="id12">Single Value Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-jar-with-plugins" id="id13">Creating a Jar with Plugins</a></li>
<li><a class="reference internal" href="#deployment" id="id14">Deployment</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Trusted Analytics Platform provides an extensibility framework that allows new commands and algorithms to be added as plug-ins to the application.</p>
<p>Plug-ins do not require the author to have a deep understanding the REST server, execution engine, or any of its libraries. The framework will create the code necessary to call the plugin through the REST API as well as generate Python client code, leaving the author to focus on the execution logic.</p>
<p>Plug-ins are written in Scala and have a few requirements that follow this pattern:</p>
<ol class="arabic simple">
<li>Declare an arguments case class.</li>
<li>Declare an return value case class.</li>
<li>Define JSON serialization (most of which is provided through library calls).</li>
<li>Write the execution logic.</li>
</ol>
</div>
<div class="section" id="when-to-write-a-plugin">
<h2>When to Write a Plugin<a class="headerlink" href="#when-to-write-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>The framework provides a few different mechanisms for customization. The simplest is using Python User-Defined Functions (UDFs). While powerful, these functions are limited in scope to basic map and filter operations, like <cite>add_columns</cite> or <cite>drop_rows</cite>, which operate on a per-row basis. Plugins offer a far more extensibility for more complex custom operations, involving entire frames, multiple frames, external sources/sinks, analytics and machine learning algorithms, etc.</p>
</div>
<div class="section" id="plugin-support-services">
<h2>Plugin Support Services<a class="headerlink" href="#plugin-support-services" title="Permalink to this headline">¶</a></h2>
<div class="section" id="plugin-life-cycle">
<h3>Plugin Life Cycle<a class="headerlink" href="#plugin-life-cycle" title="Permalink to this headline">¶</a></h3>
<p>Each invocation resulting from a user action or other source will provide an
execution context object that encapsulates the arguments passed by the user as well as other relevant metadata.</p>
</div>
<div class="section" id="logging-and-error-handling">
<h3>Logging and Error Handling<a class="headerlink" href="#logging-and-error-handling" title="Permalink to this headline">¶</a></h3>
<p>Errors that occur while running a plug-in will be reported in the
same way that internal errors within Trusted Analytics Platform are normally reported.</p>
</div>
<div class="section" id="defaulting-arguments">
<h3>Defaulting Arguments<a class="headerlink" href="#defaulting-arguments" title="Permalink to this headline">¶</a></h3>
<p>Authors should represent arguments that are not required using default values in their case classes.</p>
<p>Configuration for commands and queries should be included in the Typesafe
Config configuration file associated with the application (defaults can be
provided by a reference.conf in the plugin&#8217;s deployment jar).
Configuration details are discussed in the &#8220;Configuration&#8221; section below.
Plugins have access to the configuration, but only the section of it that
contains settings that are relevant.</p>
</div>
<div class="section" id="execution-flow">
<h3>Execution Flow<a class="headerlink" href="#execution-flow" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="R_images/dev_plug_1.png"><img alt="R_images/dev_plug_1.png" class="align-center" src="R_images/dev_plug_1.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="creating-a-commandplugin">
<h2>Creating a CommandPlugin<a class="headerlink" href="#creating-a-commandplugin" title="Permalink to this headline">¶</a></h2>
<div class="section" id="naming">
<h3>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h3>
<p>All command plugins have a unique name. This name is the command’s identification and is also used to determine how command will be “installed” within the client-facing APIs. All commands are associated with an entity, which is the type of object the command is a member of. For example, the command for sorting rows in a frame has the formal name of “frame/sort”. The “frame” is the entity for the command, and the “sort” is the name of the function. This allows the Python client to support calling the plugin like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_frame</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
<p>There is limited subtyping available with the entities. This is most common in plugins for models. For example, the “train” command for the KMeansModel looks like this: “model:k_means/train”, where “:k_means” denotes a model subtype.</p>
</div>
<div class="section" id="rest-input-and-output">
<h3>REST Input and Output<a class="headerlink" href="#rest-input-and-output" title="Permalink to this headline">¶</a></h3>
<p>Each command plug-in should define two case classes: one for
arguments, and one for return value.
The plug-in framework will ensure that the user&#8217;s Python (or JSON) commands are
converted into an instance of the argument class, and the output from the
plug-in will also be converted back to Python (or JSON) for storage in the
command execution record for later return to the client. author must provide some serialization hints.</p>
</div>
<div class="section" id="frame-and-graph-references">
<h3>Frame and Graph References<a class="headerlink" href="#frame-and-graph-references" title="Permalink to this headline">¶</a></h3>
<p>The commands associated with a frame or graph accept the frame
or graph on which they should operate as the parameter.
Use the class org.trustedanalytics.atk.domain.frame.FrameReference to represent
frames, and org.trustedanalytics.atk.domain.graph.GraphReference to represent
graphs.</p>
<p>Use a FrameReference as the type, and place this parameter first in the case
class definition if it is desired that this parameter is filled by the Frame
instance whose method is being invoked by the user.
Similarly, if the method is on a graph, using  a GraphReference in the first
position will do the trick for graph instances.</p>
</div>
<div class="section" id="single-value-results">
<h3>Single Value Results<a class="headerlink" href="#single-value-results" title="Permalink to this headline">¶</a></h3>
<p>The result returned by command plugins can be as complex as needed.
It can also be very simple — for example, a single floating point value.
Since the result type of the plugin must be a case class, the convention is to
return a case class with one field, which must be named &#8220;value&#8221;.
When the client receives such a result, it should extract and return the single
value.</p>
</div>
</div>
<div class="section" id="creating-a-jar-with-plugins">
<h2>Creating a Jar with Plugins<a class="headerlink" href="#creating-a-jar-with-plugins" title="Permalink to this headline">¶</a></h2>
<p>Plugins are deployed in jar files that contain the plugin class,
its argument and result classes, and any supporting classes it needs.</p>
<p>On application start up, the application will query all the plugin jar files
it knows about to see what plugins they provide.</p>
<p>See the module-loader documentation and the example-plugins module for to learn
more about creating plugin modules.</p>
</div>
<div class="section" id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h2>
<p>Plug-Ins should be installed in the system using jar files.
Jars that are found in the server&#8217;s lib directory will be available to be
loaded based on configuration.
The plug-ins that will be installed must be listed in the atk-plugin.conf
file.</p>
<p>In the future, plugin discovery may be further automated, and it may also be
possible to add a plugin without restarting the server.</p>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2015, Intel.
      </li>
      <li>
      Last updated on Jan 20, 2016.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>